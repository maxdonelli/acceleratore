
	acceleratore-valute    -- sottostante : forex 30minuti  --- 
	versione 0.2A -LMAX
	data : 14 settembre 2017 
	
	quando rileva esplosione di vola dopo  n candele  segue il trend con trailing-stop 
	da ottimizare il num delle candele , il valore del corpo camdela (open-close) ed il suo range
	si puo ulteriormente ottimizzare con orari ingresso /uscita e giornate di trading ( da inserire) 
	
	possibile miglioramento di ingresso/uscita con utilizzo di  DATA2 con timeframe piu basso( da verificare)
	
	NB: le quantita e i moltiplicatori sono stati inseriri per adattarsi al minmove di  Interactive Brokesr sui valori spot del forex
	    ovviamente andranno modificati nel caso di CFD
	    
	- inserimento parametro (percentOmbraIngresso) per filtrare l'ombra dell ultima candela ---> se  e' troppo alta rispetto al corpo (es > 80%) allora
														  non entro perche' v'e' un probabile ritracciamento in atto
														  l'ombra esaminata sara' qualla superiore in caso di long
														  e quella inferiore in caso di short
														  comunque sara da ottimizzare
														  
	dopo alcuni backtest  vi e' stato un lieve miglioramento ( a parita' degli altri parametri in input)	 
	niente di che  ( cira 1,5 %)  ma meglio di niente !!  
	
	14 Sett/17  -   ridotto moltiplicatore da 100000 a 1000 per adattarsi al minmove di lmax
		     -   eliminato il trailingstop espresso in dollari secondo indicazioni di alex e 
		         utilizzo di setstoploss_pt e  setprofittarget_pt  ( in pip)
		         ridotto anche la size in acquisto (50) in quanto  un CFD 
	 			lascio comunque il codice per utilizzo del trailingstop
	 			
19 dicembre -  dopo i deludenti risultati del TS postato su githube telegram ho pensato di riprendere questo che 
sicuramente va meglio , anche se fa molte meno operazioni

- inserito variante per possibilta di utilizzo trailigstop / stoploss/ takeprofit

02 genn18 --    inserito orario uscita dopo 2130 

- inserito le nuove function ( a fini didattici) ---> utili per utilizzo di data2 in futuro

- 10 genn   prova con data2  per utilizzo su TF 30 minuti grafico standard su data1 ( per ridurre gli enormi slippage)


-  11 genn18  prva con differenti TF al fine di aumentare  average trade  in modo da assorbire commissioni e slippage
   pare che il mix migliore sia 40 minuti data1( grafico fegular) e 30 min data2 (con grafico heikin) 
}

once ClearPrintLog;

// ATTENZIONE AL NUM DI CONTRATTI ---> dipende dal minmove a dal point value  del broker ,fate la giusta analisi  ed il giusto setting
//							cosi dovete inserire commissioni e slippage nelle giuste proporzioni ( da questi settaggi
//							dipende l'intero risultato del backtest --> ATTENZIONE) 


 

Input :  numerocandele(5), moltiplicCorpo(2.00), moltiplicaTotale(2.00),valoreTrailing(80), percentOmbraIngresso(180),
		numContratti(200000), stoplossUSD(80), profitUSD(130);
	 // valoreStoplossPip(10), valoreProfittargetPip(10);

         //  parametri da inserire ------>    oraIngresso(0900),oraUscita(1000),giornoNonTrado(0), 
	

var : double  ombra(0.00000),  double corpoCandela(0.00000); // eventuale blast-off ->  giornoIndecisione (false),


if marketposition <> 0 then  // imposto stop/profit , oppure il trailing- chiudo tutto alle 21,30 
		begin
			if valoreTrailing =0 then begin
				setstoploss(stoplossUSD);
				setprofittarget(profitUSD);
							   end
			else
				 setdollartrailing(valoreTrailing); 
			if time >= 2130 then 
				begin
				if marketposition = 1 then sell numContratti shares next bar at market
				else buytocover numContratti shares  next bar at market;	 
				end;
		
		end;



// verifica setup ingresso    - gli orari si possono mmodificare/ottimizzare 
if time > 900 and time < 2100 then 

begin

if Max_Esplosione_Candele(numerocandele,moltiplicCorpo,moltiplicaTotale)of data2  and marketposition =0 then

	begin
		if Close of data2 > close[1]of data2  and Max_vola_candela(percentOmbraIngresso,"long")of data2 then 	 buy numContratti shares next bar at  market;
	
	 
	  	 
		if close of data2 < close[1]of data2  and Max_vola_candela(percentOmbraIngresso,"short") of data2  then   sellshort numContratti shares next  bar at market;
		
	end;
	
end;


	


setexitonclose;  // chiusura a fine sessione ! 
